<body>

    <script>
        const tempSlackmessage = 'Hello _World!_\nSome initial *bold* ~text~\n~test text~\n&gt; hi there\n```hello world```';
        const htmlMessage = "&lt;p&gt;Hello &lt;em&gt;World!&lt;/em&gt;&lt;/p&gt;&lt;p&gt;Some initial &lt;strong&gt;bold&lt;/strong&gt; &lt;s&gt;text&lt;/s&gt;&lt;/p&gt;&lt;p&gt;&lt;s&gt;test text&lt;/s&gt;&lt;/p&gt;&lt;blockquote&gt;hi there&lt;/blockquote&gt;&lt;pre class=\"ql-syntax\" spellcheck=\"false\"&gt;hello world\nqwe\n&lt;/pre&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;"
        String.prototype.deentitize = function() {
            var ret = this.replace(/&gt;/g, '>');
            ret = ret.replace(/&lt;/g, '<');
            ret = ret.replace(/&quot;/g, '"');
            ret = ret.replace(/&apos;/g, "'");
            ret = ret.replace(/&amp;/g, '&');
            return ret;
        };

        convertHTMLToSlack(htmlMessage, true);

        function convertHTMLToSlack(message, deentitize = false){
            if(deentitize){
                message = message.deentitize();
            }
           //conver html message to slack markdown
            let slackMessage = message.replace(/<p>/g, '\n');
                slackMessage = slackMessage.replace(/<\/p>/g, '');
                slackMessage = slackMessage.replace(/<em>/g, '_');
                slackMessage = slackMessage.replace(/<\/em>/g, '_');
                slackMessage = slackMessage.replace(/<strong>/g, '*');
                slackMessage = slackMessage.replace(/<\/strong>/g, '*');
                slackMessage = slackMessage.replace(/<s>/g, '~');
                slackMessage = slackMessage.replace(/<\/s>/g, '~');
                slackMessage = slackMessage.replace(/<blockquote>/g, '>');
                slackMessage = slackMessage.replace(/<\/blockquote>/g, '\n');
                slackMessage = slackMessage.replace(/<pre class="ql-syntax" spellcheck="false">/g, '```');
                slackMessage = slackMessage.replace(/<\/pre>/g, '```');
                slackMessage = slackMessage.replace(/<br>/g, '\n');
                slackMessage = slackMessage.replace(/<\/br>/g, '\n');
                return slackMessage;
        }
        
        converSlackToHtml('\nHello World!\nSome initial *bold* text\n\n');

        function converSlackToHtml(message){
            //convert markdown message to html
            let html = '<p>'+message + '</p>';
            //new line using </p><p>
            html = html.replace(/\n/g, '</p><p>');
            //strike ~
            html = html.replace(/\~(.*?)\~/g, '<s>$1</s>');
            //bold *
            html = html.replace(/\*(.*?)\*/g, '<strong>$1</strong>');
            //italic _
            html = html.replace(/\_(.*?)\_/g, '<em>$1</em>');
            //code
            html = html.replace(/```(.*?)```/g, '<pre class="ql-syntax" spellcheck="false">$1</pre>');
            console.log(html);
        }
    
    </script>
</body>